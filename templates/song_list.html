<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Harmony | Premium Music Player</title>
  <style>
    :root {
      --primary: #1db954;
      --primary-dark: #1aa34a;
      --primary-light: #1ed760;
      --dark: #191414;
      --dark-gray: #282828;
      --light-gray: #535353;
      --light: #ffffff;
      --text-primary: #ffffff;
      --text-secondary: #b3b3b3;
      --font-main: 'Circular', 'Helvetica Neue', Helvetica, Arial, sans-serif;
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
      --shadow-md: 0 4px 6px rgba(0,0,0,0.1), 0 1px 3px rgba(0,0,0,0.08);
      --shadow-lg: 0 10px 25px rgba(0,0,0,0.1), 0 5px 10px rgba(0,0,0,0.05);
      --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-lg: 16px;
      --radius-full: 9999px;
    }

    @font-face {
      font-family: 'Circular';
      src: url('https://fonts.cdnfonts.com/css/circular-std');
      font-weight: normal;
      font-style: normal;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-main);
      background-color: var(--dark);
      color: var(--text-primary);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background-image: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                        radial-gradient(circle at center, var(--primary) 0%, transparent 70%);
      background-attachment: fixed;
      line-height: 1.6;
    }

    .music-player {
      width: 100%;
      max-width: 420px;
      background: rgba(40, 40, 40, 0.8);
      backdrop-filter: blur(16px);
      border-radius: var(--radius-lg);
      padding: 40px 30px;
      box-shadow: var(--shadow-lg);
      text-align: center;
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .music-player::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(29, 185, 84, 0.1) 0%, transparent 70%);
      z-index: -1;
      animation: rotate 20s linear infinite;
    }

    .music-info {
      margin-bottom: 30px;
      position: relative;
      z-index: 2;
    }

    .music-name {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 8px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding: 0 20px;
    }

    .artist-name {
      font-size: 16px;
      color: var(--text-secondary);
      font-weight: 500;
      margin-bottom: 5px;
    }

    .lyrics {
      font-size: 14px;
      color: var(--text-secondary);
      margin: 20px 0;
      font-style: italic;
      line-height: 1.5;
      max-height: 60px;
      overflow-y: auto;
      padding: 0 10px;
    }

    .lyrics::-webkit-scrollbar {
      width: 4px;
    }

    .lyrics::-webkit-scrollbar-thumb {
      background: var(--primary);
      border-radius: var(--radius-full);
    }

    .disk-container {
      position: relative;
      margin: 0 auto 30px;
      width: 220px;
      height: 220px;
      perspective: 1000px;
    }

    .disk {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background-size: cover;
      background-position: center;
      position: relative;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      transform-style: preserve-3d;
      transition: var(--transition);
    }

    .disk::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: var(--dark);
      border: 3px solid rgba(255, 255, 255, 0.1);
      z-index: 2;
    }

    .disk::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 50%;
      background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 50%);
    }

    .disk.play {
      animation: rotate 20s linear infinite;
    }

    .progress-container {
      width: 100%;
      margin-bottom: 25px;
    }

    .progress-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 12px;
      color: var(--text-secondary);
    }

    .progress-bar {
      width: 100%;
      height: 6px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: var(--radius-full);
      overflow: hidden;
      cursor: pointer;
    }

    .progress {
      height: 100%;
      background: var(--primary);
      border-radius: var(--radius-full);
      width: 0%;
      transition: width 0.1s linear;
    }

    .controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 25px;
      margin-top: 30px;
    }

    .control-btn {
      background: none;
      border: none;
      color: var(--text-primary);
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      justify-content: center;
      align-items: center;
      width: 40px;
      height: 40px;
    }

    .control-btn svg {
      width: 24px;
      height: 24px;
      fill: currentColor;
    }

    .control-btn:hover {
      color: var(--primary);
      transform: scale(1.1);
    }

    .play-btn {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: var(--primary);
      color: var(--dark);
      display: flex;
      justify-content: center;
      align-items: center;
      transition: var(--transition);
      box-shadow: 0 4px 15px rgba(29, 185, 84, 0.3);
    }

    .play-btn:hover {
      transform: scale(1.05);
      background: var(--primary-light);
      box-shadow: 0 6px 20px rgba(29, 185, 84, 0.4);
    }

    .play-btn.pause {
      animation: pulse 2s ease infinite;
    }

    .volume-control {
      width: 100%;
      margin-top: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .volume-icon {
      color: var(--text-secondary);
      width: 20px;
    }

    .volume-bar {
      flex: 1;
      height: 4px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: var(--radius-full);
      cursor: pointer;
    }

    .volume-progress {
      height: 100%;
      background: var(--text-secondary);
      border-radius: var(--radius-full);
      width: 80%;
    }

    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(29, 185, 84, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(29, 185, 84, 0); }
      100% { box-shadow: 0 0 0 0 rgba(29, 185, 84, 0); }
    }

    /* Hide default audio controls */
    .audio-player {
      display: none;
    }

    /* Responsive adjustments */
    @media (max-width: 480px) {
      .music-player {
        padding: 30px 20px;
        border-radius: 0;
        height: 100vh;
        max-width: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      .disk-container {
        width: 180px;
        height: 180px;
      }
    }
  </style>
</head>
<body>
  <div class="music-player">
    <div class="music-info">
      <h1 class="music-name">{{ obj.name }}</h1>
      <p class="artist-name"></p>
      <p class="lyrics">{{ obj.lyrics }}</p>
    </div>

    <div class="disk-container">
      <div class="disk" style="background-image: url('/media/{{ obj.thumbnail }}')">
        <img src="/media/{{ obj.thumbnail }}" alt="Album art" style="display: none;">
      </div>
    </div>

    <audio id="audioPlayer" class="audio-player">
      <source src="/media/{{ obj.choosevideo }}" type="audio/mp3">
    </audio>

    <div class="progress-container">
      <div class="progress-info">
        <span class="current-time">0:00</span>
        <span class="song-duration">0:00</span>
      </div>
      <div class="progress-bar">
        <div class="progress"></div>
      </div>
    </div>

    <div class="controls">
      <button class="control-btn prev-btn">
        <svg viewBox="0 0 24 24">
          <path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/>
        </svg>
      </button>
      <button class="play-btn">
        <svg class="play-icon" viewBox="0 0 24 24">
          <path d="M8 5v14l11-7z"/>
        </svg>
        <svg class="pause-icon" viewBox="0 0 24 24" style="display: none;">
          <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
        </svg>
      </button>
      <button class="control-btn next-btn">
        <svg viewBox="0 0 24 24">
          <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/>
        </svg>
      </button>
    </div>

    <div class="volume-control">
      <div class="volume-icon">
        <svg viewBox="0 0 24 24" width="20" height="20">
          <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
        </svg>
      </div>
      <div class="volume-bar">
        <div class="volume-progress"></div>
      </div>
    </div>
  </div>

  <script>
    const audioPlayer = document.getElementById('audioPlayer');
    const playBtn = document.querySelector('.play-btn');
    const disk = document.querySelector('.disk');
    const progressBar = document.querySelector('.progress-bar');
    const progress = document.querySelector('.progress');
    const currentTimeEl = document.querySelector('.current-time');
    const durationEl = document.querySelector('.song-duration');
    const playIcon = document.querySelector('.play-icon');
    const pauseIcon = document.querySelector('.pause-icon');
    const volumeBar = document.querySelector('.volume-bar');
    const volumeProgress = document.querySelector('.volume-progress');

    // Play/Pause functionality
    function togglePlay() {
      if (audioPlayer.paused) {
        audioPlayer.play();
        disk.classList.add('play');
        playBtn.classList.add('pause');
        playIcon.style.display = 'none';
        pauseIcon.style.display = 'block';
      } else {
        audioPlayer.pause();
        disk.classList.remove('play');
        playBtn.classList.remove('pause');
        playIcon.style.display = 'block';
        pauseIcon.style.display = 'none';
      }
    }

    playBtn.addEventListener('click', togglePlay);

    // Update progress bar
    function updateProgress(e) {
      const { duration, currentTime } = e.srcElement;
      const progressPercent = (currentTime / duration) * 100;
      progress.style.width = `${progressPercent}%`;
      
      // Update time display
      const durationMinutes = Math.floor(duration / 60);
      let durationSeconds = Math.floor(duration % 60);
      if (durationSeconds < 10) durationSeconds = `0${durationSeconds}`;
      
      if (duration) {
        durationEl.textContent = `${durationMinutes}:${durationSeconds}`;
      }
      
      const currentMinutes = Math.floor(currentTime / 60);
      let currentSeconds = Math.floor(currentTime % 60);
      if (currentSeconds < 10) currentSeconds = `0${currentSeconds}`;
      
      currentTimeEl.textContent = `${currentMinutes}:${currentSeconds}`;
    }

    // Set progress when clicked on progress bar
    function setProgress(e) {
      const width = this.clientWidth;
      const clickX = e.offsetX;
      const duration = audioPlayer.duration;
      audioPlayer.currentTime = (clickX / width) * duration;
    }

    // Volume control
    function setVolume(e) {
      const width = this.clientWidth;
      const clickX = e.offsetX;
      const volume = clickX / width;
      audioPlayer.volume = volume;
      volumeProgress.style.width = `${volume * 100}%`;
      
      // Change volume icon based on level
      const volumeIcon = document.querySelector('.volume-icon path');
      if (volume === 0) {
        volumeIcon.setAttribute('d', 'M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z');
      } else if (volume < 0.5) {
        volumeIcon.setAttribute('d', 'M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z');
      } else {
        volumeIcon.setAttribute('d', 'M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z');
      }
    }

    // Initialize volume
    audioPlayer.volume = 0.8;
    volumeProgress.style.width = '80%';

    // Event listeners
    audioPlayer.addEventListener('timeupdate', updateProgress);
    audioPlayer.addEventListener('ended', () => {
      disk.classList.remove('play');
      playBtn.classList.remove('pause');
      playIcon.style.display = 'block';
      pauseIcon.style.display = 'none';
    });
    progressBar.addEventListener('click', setProgress);
    volumeBar.addEventListener('click', setVolume);

    // Load song metadata
    audioPlayer.addEventListener('loadedmetadata', function() {
      const durationMinutes = Math.floor(audioPlayer.duration / 60);
      let durationSeconds = Math.floor(audioPlayer.duration % 60);
      if (durationSeconds < 10) durationSeconds = `0${durationSeconds}`;
      durationEl.textContent = `${durationMinutes}:${durationSeconds}`;
    });
  </script>
</body>
</html>